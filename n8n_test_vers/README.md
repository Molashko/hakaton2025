# Система балансировки исполнителей на базе n8n и PostgreSQL

## Описание проекта

Данный проект представляет собой систему балансировки нагрузки между исполнителями заказов, реализованную с использованием платформы автоматизации n8n и базы данных PostgreSQL. Система позволяет эффективно распределять заказы между исполнителями на основе их текущей загруженности.

## Основные функции

- **Создание заказов**: Регистрация новых заказов в системе с автоматическим назначением исполнителя
- **Управление заказами**: Полный набор CRUD операций (создание, чтение, обновление, удаление)
- **Мониторинг**: Отслеживание статистики и состояния системы
- **Балансировка нагрузки**: Автоматическое распределение заказов между исполнителями с учетом их загруженности

## Технологии

- **n8n**: Платформа автоматизации рабочих процессов
- **PostgreSQL**: Реляционная база данных для хранения информации о заказах и исполнителях
- **RESTful API**: Интерфейс для взаимодействия с системой

## Структура проекта

- `executor_balancer_postgresql.json` - Основной рабочий процесс n8n для работы с PostgreSQL
- `test_api.ps1` - PowerShell скрипт для тестирования API
- `start_windows.bat` и `stop_windows.bat` - Скрипты для запуска и остановки сервера
- `docker-compose.yml` - Конфигурация Docker для развертывания системы

## Установка и настройка

### Предварительные требования

- Docker и Docker Compose
- PostgreSQL (локальный или в контейнере)
- n8n (будет установлен через Docker)

### Шаги по установке

1. Клонируйте репозиторий:
   ```
   git clone <url-репозитория>
   cd executor_balancer_n8n_redis
   ```

2. Инициализируйте базу данных PostgreSQL:
   ```
   psql -U postgres -f init_database.sql
   ```

3. Запустите систему с помощью Docker Compose:
   ```
   docker-compose up -d
   ```

4. Импортируйте рабочий процесс в n8n:
   - Откройте n8n в браузере (http://localhost:5678)
   - Импортируйте файл `executor_balancer_postgresql.json`
   - Активируйте рабочий процесс

### Запуск без Docker

Для запуска без Docker можно использовать скрипт:
```
./start_windows.bat
```

Для остановки:
```
./stop_windows.bat
```

## API Endpoints

- `POST /orders` - Создание нового заказа
- `GET /orders` - Получение списка всех заказов
- `GET /orders/:id` - Получение информации о конкретном заказе
- `PUT /orders/:id` - Обновление информации о заказе
- `DELETE /orders/:id` - Удаление заказа
- `GET /stats` - Получение статистики
- `GET /health` - Проверка состояния системы

## Тестирование

Для тестирования API можно использовать скрипт `test_api.ps1`:
```
./test_api.ps1
```